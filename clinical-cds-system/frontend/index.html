<!DOCTYPE html>
<html>
<head>
    <title>Clinical Decision Support System</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        .container { display: flex; gap: 30px; }
        .input-section { flex: 1; }
        .results { flex: 1; background: #f5f5f5; padding: 20px; border-radius: 10px; }
        textarea { width: 100%; height: 150px; padding: 10px; }
        button { background: #007bff; color: white; border: none; padding: 12px 24px; cursor: pointer; }
        .disease-card { background: white; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .confidence-bar { height: 20px; background: #4CAF50; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>ü©∫ Clinical Decision Support System</h1>
    <div class="container">
        <div class="input-section">
            <h3>Enter Patient Symptoms:</h3>
            <textarea id="symptoms" placeholder="e.g., headache, fever for 3 days, nausea..."></textarea>
            <button onclick="predict()">Analyze Symptoms</button>

            <h4>Quick Select:</h4>
            <div id="quick-symptoms">
                <button class="symptom-btn" onclick="addSymptom('headache')">Headache</button>
                <button class="symptom-btn" onclick="addSymptom('fever')">Fever</button>
                <button class="symptom-btn" onclick="addSymptom('chest pain')">Chest Pain</button>
                <button class="symptom-btn" onclick="addSymptom('fatigue')">Fatigue</button>
            </div>
        </div>

        <div class="results">
            <h3>Diagnostic Results:</h3>
            <div id="results"></div>
            <div id="recommendations"></div>
        </div>
    </div>

    <script>
        function addSymptom(symptom) {
            const textarea = document.getElementById('symptoms');
            textarea.value += (textarea.value ? ', ' : '') + symptom;
        }

        async function predict() {
            const symptoms = document.getElementById('symptoms').value;

            // Show loading
            document.getElementById('results').innerHTML = '<p>Analyzing... ‚è≥</p>';

            try {
                const response = await fetch('http://localhost:5000/predict', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({symptoms: symptoms})
                });

                const data = await response.json();
                displayResults(data);
            } catch (error) {
                document.getElementById('results').innerHTML =
                    '<p style="color:red">Error: ' + error + '</p>';
            }
        }

        function displayResults(data) {
            let html = '<h4>Top Predictions:</h4>';

            data.predictions.forEach(pred => {
                html += `
                <div class="disease-card">
                    <strong>${pred.disease}</strong>
                    <div>Confidence: ${pred.confidence}%</div>
                    <div class="confidence-bar" style="width:${pred.confidence}%"></div>
                    <small>Tests: ${pred.recommended_tests.join(', ')}</small>
                </div>
                `;
            });

            document.getElementById('results').innerHTML = html;

            // Show recommendations
            if (data.recommendations) {
                const rec = data.recommendations;
                document.getElementById('recommendations').innerHTML = `
                    <h4>Recommendations:</h4>
                    <p><strong>Urgency:</strong> ${rec.urgent}</p>
                    <p><strong>Self-care:</strong> ${rec.self_care}</p>
                    <p><strong>Avoid:</strong> ${rec.avoid}</p>
                `;
            }
        }
    </script>
</body>
</html>